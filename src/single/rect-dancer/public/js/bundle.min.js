!function a(o,s,c){function h(e,t){if(!s[e]){if(!o[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(u)return u(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[e]={exports:{}};o[e][0].call(r.exports,function(t){return h(o[e][1][t]||t)},r,r.exports,a,o,s,c)}return s[e].exports}for(var u="function"==typeof require&&require,t=0;t<c.length;t++)h(c[t]);return h}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.width=32,this.height=32,this.color="#e2543e",this.speed=256,this.directRadians=0}return n(t,[{key:"faceTo",value:function(t,e){this.directRadians=Math.atan2(e-this.y,t-this.x)}},{key:"run",value:function(t){this.x+=Math.cos(this.directRadians)*this.speed*t,this.y+=Math.sin(this.directRadians)*this.speed*t}}]),t}();i.default=r},{}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.collidingRecord=[],this.collidingDelay=1e3}return n(t,[{key:"CircleRectColliding",value:function(t,e){if(this.collidingRecord[t]&&this.collidingRecord[t].with===e&&(new Date).getTime()<this.collidingRecord[t].time.getTime()+this.collidingDelay)return!1;var i=Math.abs(t.x-e.x-e.w/2),n=Math.abs(t.y-e.y-e.h/2);if(i>e.w/2+t.r)return!1;if(n>e.h/2+t.r)return!1;if(i<=e.w/2)return!0;if(n<=e.h/2)return!0;var r=i-e.w/2,a=n-e.h/2,o=r*r+a*a<=t.r*t.r;return o&&(this.collidingRecord[t]={with:e,time:new Date}),o}},{key:"RectRectColliding",value:function(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.height+t.y>e.y}},{key:"RectPointColliding",value:function(t,e){return t.x<=e.x&&t.x+t.width>=e.x&&t.y<=e.y&&t.height+t.y>=e.y}}]),t}();i.default=r},{}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=o(t("./Ball")),n=o(t("./Collision")),r=o(t("./ScrollingBackground")),a=o(t("./Score"));function o(t){return t&&t.__esModule?t:{default:t}}var c={Resource:{},difficulty:0},h=new n.default;c.Intro={level:1,enter:function(){},create:function(){this.app.scrollingBackground=new r.default(this.app.images.background),this.app.scrollingBackground.init(this.app.width,this.app.height),this.app.thomas=new s.default,this.app.thomas.x=this.app.center.x,this.app.thomas.y=this.app.center.y,this.addButton={text:"＋",x:this.app.center.x+200,y:this.app.center.y,width:40,height:40,background_color:"#eee"},this.minusButton={text:"－",x:this.app.center.x-200,y:this.app.center.y,width:40,height:40,background_color:"#eee"},this.startButton={text:"Start",x:this.app.center.x,y:this.app.center.y+200,width:80,height:40,background_color:"#eee"}},step:function(t){},render:function(t){var e=this.addButton,i=this.minusButton,n=this.startButton;this.app.layer.clear("#000"),this.app.scrollingBackground.render(this.app),this.app.layer.font("40px Georgia").fillText("Level: "+this.level,this.app.center.x-30,this.app.center.y).fillStyle(e.height+"px #abc").textWithBackground(e.text,e.x,e.y,e.background_color).fillStyle(i.height+"px #abc").textWithBackground(i.text,i.x,i.y,i.background_color).fillStyle(n.height+"px #abc").textWithBackground(n.text,n.x,n.y,n.background_color)},mousedown:function(t){h.RectPointColliding(this.addButton,t)&&this.level++,h.RectPointColliding(this.minusButton,t)&&this.level--,10<this.level&&(this.level=10),this.level<1&&(this.level=1),h.RectPointColliding(this.startButton,t)&&(c.difficulty=this.level/10,this.app.setState(c.Game))}},c.Game={enter:function(){c.Resource=this.app.music.play("music",!0),c.enemies=[],c.score=new a.default},create:function(){this.app.scrollingBackground=new r.default(this.app.images.background),this.app.scrollingBackground.init(this.app.width,this.app.height),this.app.thomas=new s.default,this.app.thomas.x=this.app.center.x,this.app.thomas.y=this.app.center.y},step:function(e){var i=this,n=this.app.thomas,r=this.app.scrollingBackground.move(n.speed*e);c.score.add(-r[1]*c.difficulty),c.score.save();var t=c.enemies;if(c.score.newScore()&&Math.random()<c.difficulty){var a=new s.default;a.speed=256,a.x=Math.random()*this.app.width,a.y=0,a.directRadians=Math.asin(1),a.color="#e24fa2",t.push(a)}t.forEach(function(t){t.run(e),t.x-=r[0],t.y-=r[1],h.RectRectColliding(t,n)&&(console.log("collission"),i.app.music.stop(c.Resource),i.app.setState(c.Game))});for(var o=t.length-1;0<=o;)t[o].y>this.app.height&&t.splice(o,1),o-=1},render:function(t){var e=this,i=this.app.thomas;this.app.layer.clear("#000"),this.app.scrollingBackground.render(this.app),this.app.layer.fillStyle(i.color).fillRect(i.x,i.y,i.width,i.height).font("40px Georgia").fillText("Current: "+c.score.getScore(),this.app.width-300,160).font("40px Green").fillText("High: "+c.score.getHighScore(),this.app.width-300,80),c.enemies.forEach(function(t){e.app.layer.fillStyle(t.color).fillRect(t.x,t.y,t.width,t.height)})},mousedown:function(){},mousemove:function(t){this.app.scrollingBackground.directRadians=Math.atan2(t.y-this.app.center.y,t.x-this.app.center.x)}},i.default=c},{"./Ball":1,"./Collision":2,"./Score":4,"./ScrollingBackground":5}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scoreCurrent=0,this.scoreMax=0,this.highscore=localStorage.getItem("highscore")||0}return n(t,[{key:"save",value:function(){this.scoreCurrent>this.highscore&&(this.highscore=this.scoreCurrent,localStorage.setItem("highscore",this.highscore))}},{key:"clear",value:function(){this.scoreCurrent=0,this.scoreMax=0}},{key:"add",value:function(t){this.scoreCurrent+=t,this.scoreMax=Math.max(this.scoreMax,this.scoreCurrent)}},{key:"newScore",value:function(){return this.scoreCurrent===this.scoreMax}},{key:"getHighScore",value:function(){return Number(this.highscore).toFixed(2)}},{key:"getScore",value:function(){return Number(this.scoreCurrent).toFixed(2)}}]),t}();i.default=r},{}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.backgrounds=[],this.bw=t.width,this.bh=t.height,this.layer={},this.directRadians=Math.asin(-1)}return n(e,[{key:"move",value:function(t){var e=this,i=Math.cos(this.directRadians)*t,n=Math.sin(this.directRadians)*t,r=this.layer.w,a=this.layer.h,o=Math.ceil(r/this.bw)+1,s=Math.ceil(a/this.bh)+1;return this.backgrounds.forEach(function(t){t[0]-=i,t[1]-=n,t[0]<-e.bw&&(t[0]+=(o+1)*e.bw),t[0]>r&&(t[0]-=(o+1)*e.bw),t[1]<-e.bh&&(t[1]+=(s+1)*e.bh),t[1]>a&&(t[1]-=(s+1)*e.bh)}),[i,n]}},{key:"init",value:function(t,e){this.layer={w:t,h:e};for(var i=Math.ceil(t/this.bw)+1,n=Math.ceil(e/this.bh)+1,r=-1;r<=i;r++)for(var a=-1;a<=n;a++)this.backgrounds.push([r*this.bw,a*this.bh])}},{key:"render",value:function(e){this.backgrounds.forEach(function(t){e.layer.drawImage(e.images.background,t[0],t[1])})}}]),e}();i.default=r},{}],6:[function(t,e,i){"use strict";var n,r=t("./Engine"),a=(n=r)&&n.__esModule?n:{default:n};new PLAYGROUND.Application({paths:{sounds:"/sounds/",rewriteURL:{background:"/images/background.png"}},create:function(){this.loadSounds("music"),this.loadImage("<background>")},ready:function(){this.setState(a.default.Intro)},mousedown:function(t){},scale:.5})},{"./Engine":3}]},{},[6]);
//# sourceMappingURL=bundle.min.js.map
